<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Wise Soweto Outreach - Final Report</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="assets/randwaterLogo.jpg" type="image/png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #0066cc;
            --secondary-blue: #0099ff;
            --light-blue: #e6f2ff;
            --dark-blue: #004d99;
            --accent-teal: #00cccc;
            --white: #ffffff;
            --light-gray: #f5f7fa;
            --text-dark: #333333;
            --success-green: #28a745;
            --warning-orange: #ffc107;
            --danger-red: #dc3545;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            padding: 20px;
            min-height: 100vh;
            overflow-x: auto;
            color: var(--text-dark);
            line-height: 1.6;
        }

        .dashboard {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            position: relative;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo {
            font-size: 3rem;
            color: white;
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header h2 {
            font-size: 1.5rem;
            font-weight: 500;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .date-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .pulse-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        /* Report Navigation */
        .report-nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Grid Layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 102, 204, 0.1), transparent);
            transition: left 0.5s;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            background: rgba(255, 255, 255, 1);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            padding-bottom: 10px;
            transition: color 0.3s ease;
        }

        .card:hover .card-title {
            color: var(--primary-blue);
        }

        .card-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-blue), var(--accent-teal));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .card:hover .card-title::after {
            width: 80%;
        }

        .chart-container {
            position: relative;
            height: 250px;
            transition: transform 0.3s ease;
        }

        .card:hover .chart-container {
            transform: scale(1.05);
        }

        .large {
            grid-column: span 2;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        /* Stats Row */
        .stats-row {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
        }

        .stat {
            text-align: center;
            transition: transform 0.3s ease;
        }

        .card:hover .stat {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-blue);
            transition: all 0.3s ease;
        }

        .card:hover .stat-value {
            color: var(--dark-blue);
            transform: scale(1.1);
        }

        .stat-label {
            font-size: 0.85rem;
            color: #718096;
            margin-top: 5px;
        }

        /* Quote Cards */
        .quote-card {
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--white) 100%);
            border-left: 5px solid var(--accent-teal);
        }

        .quote-text {
            font-style: italic;
            color: var(--dark-blue);
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .quote-author {
            text-align: right;
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* Insights Cards */
        .insights-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid var(--warning-orange);
        }

        .insights-list {
            list-style-type: none;
            padding-left: 0;
        }

        .insights-list li {
            padding: 10px 0;
            border-bottom: 1px dashed #e2e8f0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .insights-list li:last-child {
            border-bottom: none;
        }

        .insights-list li i {
            color: var(--accent-teal);
            margin-top: 3px;
        }

        /* Solutions Cards */
        .solutions-card {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 5px solid var(--success-green);
        }

        .solutions-list {
            list-style-type: none;
            padding-left: 0;
        }

        .solutions-list li {
            padding: 10px 0;
            border-bottom: 1px dashed #e2e8f0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .solutions-list li:last-child {
            border-bottom: none;
        }

        .solutions-list li i {
            color: var(--success-green);
            margin-top: 3px;
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            color: white;
            margin: 40px 0 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section-header h2 {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .section-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.3);
            }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .large {
                grid-column: span 2;
            }
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .large, .full-width {
                grid-column: span 1;
            }
            .header h1 {
                font-size: 1.8rem;
            }
            .controls, .report-nav {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <div class="header">
            <div class="logo-container">
                <i class="fas fa-tint logo"></i>
                <h1>Water Wise Soweto Outreach</h1>
            </div>
            <h2>Final Report (Day 1 to Summit Completion)</h2>
            <p>The final Soweto outreach phase, spanning all groundwork days and culminating in the Water Wise Summit, achieved high participation and deep qualitative engagement. The data collection effort was robust, with strong community feedback and measurable insights on water usage, awareness, and conservation challenges.</p>
            <div class="date-badge">
                <span class="pulse-dot"></span>Data Sources: Household Surveys, Summit Feedback, Focus Groups
            </div>
            
            <div class="report-nav">
                <button class="nav-btn active" id="overviewBtn">
                    <i class="fas fa-chart-pie"></i>Overview
                </button>
                <button class="nav-btn" id="quantitativeBtn">
                    <i class="fas fa-chart-bar"></i>Quantitative Analysis
                </button>
                <button class="nav-btn" id="qualitativeBtn">
                    <i class="fas fa-comments"></i>Qualitative Insights
                </button>
                <button class="nav-btn" id="recommendationsBtn">
                    <i class="fas fa-lightbulb"></i>Recommendations
                </button>
            </div>
            
            <div class="controls">
                <button class="control-btn" id="printBtn">
                    <i class="fas fa-print"></i>Print Report
                </button>
                <button class="control-btn" id="downloadBtn">
                    <i class="fas fa-download"></i>Download Data
                </button>
            </div>
        </div>

        <!-- Overview Section -->
        <div class="report-content" id="overviewReport">
            <div class="section-header">
                <h2><i class="fas fa-chart-pie"></i> Project Overview</h2>
                <p>Summary of the Soweto Water Wise Outreach Initiative</p>
            </div>

            <div class="grid">
                <div class="card large">
                    <div class="card-title">Project Timeline & Key Milestones</div>
                    <div class="chart-container">
                        <canvas id="timelineChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Data Collection Summary</div>
                    <div class="chart-container">
                        <canvas id="dataCollectionChart"></canvas>
                    </div>
                </div>

                <div class="card large">
                    <div class="card-title">Community Engagement Metrics</div>
                    <div class="chart-container">
                        <canvas id="engagementChart"></canvas>
                    </div>
                    <div class="stats-row">
                        <div class="stat">
                            <div class="stat-value">78%</div>
                            <div class="stat-label">Workshop Interest</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">80%</div>
                            <div class="stat-label">Water Concern</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">90%</div>
                            <div class="stat-label">Community Role Belief</div>
                        </div>
                    </div>
                </div>

                <div class="card full-width insights-card">
                    <div class="card-title">Key Project Achievements</div>
                    <ul class="insights-list">
                        <li><i class="fas fa-check-circle"></i> <strong>High Participation:</strong> Robust data collection across all outreach days with strong community engagement</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Deep Qualitative Insights:</strong> Captured authentic community voices and practical challenges</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Measurable Impact:</strong> Clear data-driven insights on water usage, awareness, and conservation challenges</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Trust Building:</strong> Established stronger connections between community and water authorities</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Actionable Intelligence:</strong> Data-to-action pipeline for evidence-based interventions</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Quantitative Analysis Section -->
        <div class="report-content" id="quantitativeReport" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-chart-bar"></i> Quantitative Analysis</h2>
                <p>Data-driven insights and trends from household surveys</p>
            </div>

            <div class="grid">
                <div class="card">
                    <div class="card-title">Household Size Distribution</div>
                    <div class="chart-container">
                        <canvas id="householdChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Dwelling Types</div>
                    <div class="chart-container">
                        <canvas id="dwellingChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Property Ownership</div>
                    <div class="chart-container">
                        <canvas id="ownershipChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Water Meter Access</div>
                    <div class="chart-container">
                        <canvas id="meterChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Water Shortage Frequency</div>
                    <div class="chart-container">
                        <canvas id="shortageChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Infrastructure Rating</div>
                    <div class="chart-container">
                        <canvas id="infrastructureChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Water-Saving Devices Usage</div>
                    <div class="chart-container">
                        <canvas id="devicesChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Garden Watering Methods</div>
                    <div class="chart-container">
                        <canvas id="gardenChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Water Conservation Education</div>
                    <div class="chart-container">
                        <canvas id="educationChart"></canvas>
                    </div>
                </div>

                <div class="card large">
                    <div class="card-title">Community Willingness & Engagement</div>
                    <div class="chart-container">
                        <canvas id="willingnessChart"></canvas>
                    </div>
                    <div class="stats-row">
                        <div class="stat">
                            <div class="stat-value">78%</div>
                            <div class="stat-label">Workshop Interest</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">75%</div>
                            <div class="stat-label">Adoption Willingness</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">60%</div>
                            <div class="stat-label">Reporting Knowledge Gap</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Qualitative Insights Section -->
        <div class="report-content" id="qualitativeReport" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-comments"></i> Qualitative Insights</h2>
                <p>Community voices, challenges, and summit feedback</p>
            </div>

            <div class="grid">
                <div class="card large quote-card">
                    <div class="card-title">Resident Voices - Key Challenges</div>
                    <div class="quote-text">
                        "We don't know when water will go. No one tells us."
                    </div>
                    <div class="quote-author">- Soweto Resident</div>
                    <div class="quote-text" style="margin-top: 15px;">
                        "Our meter doesn't work, and no one comes to fix it."
                    </div>
                    <div class="quote-author">- Soweto Resident</div>
                    <div class="quote-text" style="margin-top: 15px;">
                        "We wash food with grey water when there's no water."
                    </div>
                    <div class="quote-author">- Soweto Resident</div>
                </div>

                <div class="card">
                    <div class="card-title">Communication Gaps</div>
                    <div class="chart-container">
                        <canvas id="communicationChart"></canvas>
                    </div>
                </div>

                <div class="card large insights-card">
                    <div class="card-title">Key Challenges Identified</div>
                    <ul class="insights-list">
                        <li><i class="fas fa-exclamation-triangle"></i> <strong>Lack of communication</strong> on planned outages</li>
                        <li><i class="fas fa-tachometer-alt"></i> <strong>Broken or non-functional water meters</strong></li>
                        <li><i class="fas fa-recycle"></i> <strong>Reliance on greywater</strong> for cleaning and food washing</li>
                        <li><i class="fas fa-question-circle"></i> <strong>Limited knowledge</strong> of how or where to report leaks</li>
                        <li><i class="fas fa-phone-slash"></i> Preference for <strong>local community offices</strong> rather than only phone-based support</li>
                    </ul>
                </div>

                <div class="card large">
                    <div class="card-title">Water Wise Summit Insights</div>
                    <div class="chart-container">
                        <canvas id="summitChart"></canvas>
                    </div>
                </div>

                <div class="card full-width insights-card">
                    <div class="card-title">Summit Findings - Problems & Solutions</div>
                    <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h3 style="color: var(--dark-blue); margin-bottom: 15px;">Problems Identified</h3>
                            <ul class="insights-list">
                                <li><i class="fas fa-trash"></i> Water pollution from waste dumping and litter</li>
                                <li><i class="fas fa-dumpster"></i> Lack of bins and sanitation infrastructure</li>
                                <li><i class="fas fa-ban"></i> Blockages due to improper disposal (pads, nappies, plastics)</li>
                                <li><i class="fas fa-tools"></i> Low technical capacity to address leaks and water quality</li>
                            </ul>
                        </div>
                        <div>
                            <h3 style="color: var(--dark-blue); margin-bottom: 15px;">Proposed Solutions</h3>
                            <ul class="insights-list">
                                <li><i class="fas fa-graduation-cap"></i> Upskilling locals in plumbing and water treatment</li>
                                <li><i class="fas fa-users"></i> Creating a "pool of plumbers" for rapid response</li>
                                <li><i class="fas fa-mobile-alt"></i> Report Leaks App integration</li>
                                <li><i class="fas fa-chalkboard-teacher"></i> Education workshops for youth and community groups</li>
                                <li><i class="fas fa-building"></i> Community reporting office for local issue handling</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recommendations Section -->
        <div class="report-content" id="recommendationsReport" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-lightbulb"></i> Recommendations & Next Steps</h2>
                <p>Evidence-based interventions for sustainable water management</p>
            </div>

            <div class="grid">
                <div class="card large solutions-card">
                    <div class="card-title">Key Recommendations</div>
                    <ul class="solutions-list">
                        <li><i class="fas fa-mobile-alt"></i> <strong>Launch the "Report Leaks App"</strong> with GIS tagging for faster response</li>
                        <li><i class="fas fa-wrench"></i> <strong>Build a Community Plumbing Network</strong> - creating local jobs + faster leak repair</li>
                        <li><i class="fas fa-chalkboard-teacher"></i> <strong>Design Educational Campaigns</strong> using real survey data insights</li>
                        <li><i class="fas fa-bullhorn"></i> <strong>Install community noticeboards or SMS alerts</strong> for planned outages</li>
                        <li><i class="fas fa-expand-arrows-alt"></i> <strong>Expand the Soweto model</strong> to Thembisa and Alexandra</li>
                        <li><i class="fas fa-chart-line"></i> <strong>Visualize insights in Power BI/Tableau</strong> for dynamic tracking</li>
                    </ul>
                </div>

                <div class="card">
                    <div class="card-title">Implementation Timeline</div>
                    <div class="chart-container">
                        <canvas id="implementationChart"></canvas>
                    </div>
                </div>

                <div class="card full-width">
                    <div class="card-title">Community Value Added</div>
                    <div class="quote-text">
                        This project built both trust and data â€” turning community voices into structured insights that guide water policy and outreach. By leveraging this data-to-action pipeline, Rand Water and Water Wise can make evidence-based interventions that are responsive, localized, and sustainable.
                    </div>
                    <div class="stats-row">
                        <div class="stat">
                            <div class="stat-value">Trust</div>
                            <div class="stat-label">Community Connection</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">Data</div>
                            <div class="stat-label">Structured Insights</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">Action</div>
                            <div class="stat-label">Evidence-Based Policy</div>
                        </div>
                    </div>
                </div>

                <div class="card large">
                    <div class="card-title">Expected Impact Metrics</div>
                    <div class="chart-container">
                        <canvas id="impactChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Color scheme
        const colors = {
            primary: ['#0066cc', '#0099ff', '#00cccc', '#004d99', '#008fb3', '#00b3b3'],
            gradient1: ['rgba(0, 102, 204, 0.8)', 'rgba(0, 153, 255, 0.8)'],
            gradient2: ['rgba(0, 204, 204, 0.8)', 'rgba(0, 179, 179, 0.8)']
        };

        // Store chart instances
        const chartInstances = {};

        // Initialize all charts when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeOverviewCharts();
            
            // Set up report navigation
            document.getElementById('overviewBtn').addEventListener('click', function() {
                switchReport('overview');
            });

            document.getElementById('quantitativeBtn').addEventListener('click', function() {
                switchReport('quantitative');
                if (!chartInstances.quantitativeInitialized) {
                    initializeQuantitativeCharts();
                    chartInstances.quantitativeInitialized = true;
                }
            });

            document.getElementById('qualitativeBtn').addEventListener('click', function() {
                switchReport('qualitative');
                if (!chartInstances.qualitativeInitialized) {
                    initializeQualitativeCharts();
                    chartInstances.qualitativeInitialized = true;
                }
            });

            document.getElementById('recommendationsBtn').addEventListener('click', function() {
                switchReport('recommendations');
                if (!chartInstances.recommendationsInitialized) {
                    initializeRecommendationsCharts();
                    chartInstances.recommendationsInitialized = true;
                }
            });

            // Set up export functionality
            document.getElementById('printBtn').addEventListener('click', function() {
                window.print();
            });

            document.getElementById('downloadBtn').addEventListener('click', downloadExcel);
        });

        // Initialize Overview Charts
        function initializeOverviewCharts() {
            createTimelineChart('timelineChart');
            createDataCollectionChart('dataCollectionChart');
            createEngagementChart('engagementChart');
        }

        // Initialize Quantitative Charts
        function initializeQuantitativeCharts() {
            createHouseholdChart('householdChart', [33.5, 25, 25, 16.5]);
            createDwellingChart('dwellingChart', [64.3, 19, 4.8, 11.9]);
            createOwnershipChart('ownershipChart', [50, 35.7, 14.3]);
            createMeterChart('meterChart', [59.5, 26.2, 14.3]);
            createShortageChart('shortageChart', [66.7, 19, 2.4, 11.9]);
            createInfrastructureChart('infrastructureChart', [21.4, 9.5, 21.4, 21.4, 7.1, 19]);
            createDevicesChart('devicesChart', [57.1, 11.9, 9.5, 7.1, 2.4, 11.9]);
            createGardenChart('gardenChart', [38.1, 26.2, 9.5, 7.1, 7.1, 11.9]);
            createEducationChart('educationChart', [38.1, 45.2, 4.8, 11.9]);
            createWillingnessChart('willingnessChart', [73.8, 7.1, 19]);
        }

        // Initialize Qualitative Charts
        function initializeQualitativeCharts() {
            createCommunicationChart('communicationChart');
            createSummitChart('summitChart');
        }

        // Initialize Recommendations Charts
        function initializeRecommendationsCharts() {
            createImplementationChart('implementationChart');
            createImpactChart('impactChart');
        }

        // Switch between reports
        function switchReport(reportType) {
            // Hide all reports
            document.querySelectorAll('.report-content').forEach(el => {
                el.style.display = 'none';
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected report and activate button
            document.getElementById(reportType + 'Report').style.display = 'block';
            document.getElementById(reportType + 'Btn').classList.add('active');
        }

        // Chart creation functions
        function createTimelineChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Summit'],
                    datasets: [{
                        label: 'Surveys Completed',
                        data: [12, 30, 25, 150],
                        backgroundColor: colors.primary[0],
                        borderRadius: 10
                    }, {
                        label: 'Community Engagement',
                        data: [45, 75, 80, 200],
                        backgroundColor: colors.primary[2],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Participants'
                            }
                        }
                    }
                }
            });
        }

        function createDataCollectionChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Household Surveys', 'Summit Feedback', 'Focus Groups', 'Observational Data'],
                    datasets: [{
                        data: [67, 150, 45, 30],
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createEngagementChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Workshop Interest', 'Water Concern', 'Community Role Belief', 'Willingness to Adopt'],
                    datasets: [{
                        data: [78, 80, 90, 75],
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createHouseholdChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['6 or more', '1 person', '4-5 people', '2-3 people'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createDwellingChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Brick house', 'Informal settlement', 'RDP house', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createOwnershipChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Own', 'Rent', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createMeterChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createShortageChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Occasionally', 'Frequently', 'Rarely', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createInfrastructureChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'polarArea',
                data: {
                    labels: ['Poor', 'Very poor', 'Fair', 'Good', 'Excellent', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary.map(c => c + 'CC')
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createDevicesChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Dual-flush toilet', 'Dual-flush + Low-flow', 'Low-flow showerhead', 'Dual-flush + Greywater', 'Greywater system', 'None/Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createGardenChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ["Don't water garden", 'Hosepipe', 'Not applicable', 'Bucket', 'Sprinkler', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createEducationChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No', 'Not sure', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createWillingnessChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Yes', 'Maybe', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createCommunicationChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Lack of outage info', 'Meter issues', 'Greywater reliance', 'Reporting knowledge gap', 'Prefer local offices'],
                    datasets: [{
                        label: 'Residents Reporting Issue',
                        data: [85, 70, 65, 60, 75],
                        backgroundColor: colors.primary[0],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createSummitChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Water pollution', 'Lack of bins', 'Blockages', 'Technical capacity'],
                    datasets: [{
                        label: 'Problems Identified',
                        data: [80, 75, 70, 65],
                        backgroundColor: colors.primary[1],
                        borderRadius: 10
                    }, {
                        label: 'Solutions Proposed',
                        data: [85, 80, 75, 90],
                        backgroundColor: colors.primary[2],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createImplementationChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024', 'Q1 2025'],
                    datasets: [{
                        label: 'Report Leaks App',
                        data: [10, 40, 70, 90, 100],
                        borderColor: colors.primary[0],
                        backgroundColor: colors.primary[0] + '20',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Community Plumbing Network',
                        data: [5, 25, 60, 85, 95],
                        borderColor: colors.primary[1],
                        backgroundColor: colors.primary[1] + '20',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Education Campaigns',
                        data: [15, 45, 75, 90, 100],
                        borderColor: colors.primary[2],
                        backgroundColor: colors.primary[2] + '20',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createImpactChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Leak Reporting', 'Response Time', 'Water Conservation', 'Community Engagement', 'Infrastructure Rating'],
                    datasets: [{
                        label: 'Current',
                        data: [30, 40, 45, 65, 50],
                        backgroundColor: colors.primary[0],
                        borderRadius: 5
                    }, {
                        label: 'Target (12 months)',
                        data: [80, 75, 70, 85, 75],
                        backgroundColor: colors.primary[2],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        // Download Excel functionality
        function downloadExcel() {
            // Create data for Excel format
            const data = [
                ['Water Wise Soweto Outreach - Final Report Data', '', '', ''],
                ['', '', '', ''],
                ['Quantitative Analysis Summary', '', '', ''],
                ['Metric', 'Value', 'Insight', ''],
                ['Household Size (4-5 people)', '25%', 'Average household size', ''],
                ['Brick House Dwellings', '64.3%', 'Majority housing type', ''],
                ['Property Ownership', '50%', 'Half of residents own their property', ''],
                ['Water Meter Access', '59.5%', 'Significant portion lack functional meters', ''],
                ['Water Shortages (Occasionally)', '66.7%', 'Most experience regular shortages', ''],
                ['Infrastructure Rating (Fair)', '21.4%', 'Infrastructure generally rated as fair', ''],
                ['Water-Saving Devices', '15-20%', 'Low adoption of water-saving technology', ''],
                ['Water Conservation Education', '45%', 'Less than half received education', ''],
                ['Workshop Interest', '78%', 'Strong community interest in workshops', ''],
                ['Willingness to Adopt', '75%', 'High willingness to adopt water-saving practices', ''],
                ['', '', '', ''],
                ['Qualitative Insights Summary', '', '', ''],
                ['Challenge', 'Impact', 'Resident Quote', ''],
                ['Lack of Communication', 'High', '"We don\'t know when water will go. No one tells us."', ''],
                ['Non-functional Meters', 'Medium-High', '"Our meter doesn\'t work, and no one comes to fix it."', ''],
                ['Greywater Reliance', 'Medium', '"We wash food with grey water when there\'s no water."', ''],
                ['Reporting Knowledge Gap', 'High', 'Over 60% didn\'t know how to report leaks', ''],
                ['Preference for Local Support', 'Medium', 'Residents prefer local offices over phone support', '']
            ];

            // Create worksheet
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Soweto Final Report");
            
            // Generate XLSX file and trigger download
            XLSX.writeFile(wb, "Water_Wise_Soweto_Final_Report.xlsx");
        }
    </script>
</body>
</html>