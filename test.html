<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Wise Soweto Outreach - Final Report</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="assets/randwaterLogo.jpg" type="image/png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #0066cc;
            --secondary-blue: #0099ff;
            --light-blue: #e6f2ff;
            --dark-blue: #004d99;
            --accent-teal: #00cccc;
            --white: #ffffff;
            --light-gray: #f5f7fa;
            --text-dark: #333333;
            --success-green: #28a745;
            --warning-orange: #ffc107;
            --danger-red: #dc3545;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            padding: 20px;
            min-height: 100vh;
            overflow-x: auto;
            color: var(--text-dark);
            line-height: 1.6;
        }

        .dashboard {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            position: relative;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo {
            font-size: 3rem;
            color: white;
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .header h2 {
            font-size: 1.5rem;
            font-weight: 500;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .date-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .pulse-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        /* Report Navigation */
        .report-nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
        }

        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: rgba(255, 255, 255, 0.3);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Tooltip */
        .tooltip {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.8rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        .nav-btn:hover .tooltip {
            opacity: 1;
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Quick Stats Dashboard */
        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #718096;
        }

        /* Grid Layout */
        .grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 102, 204, 0.1), transparent);
            transition: left 0.5s;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            background: rgba(255, 255, 255, 1);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            padding-bottom: 10px;
            transition: color 0.3s ease;
        }

        .card:hover .card-title {
            color: var(--primary-blue);
        }

        .card-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-blue), var(--accent-teal));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .card:hover .card-title::after {
            width: 80%;
        }

        .chart-container {
            position: relative;
            height: 250px;
            transition: transform 0.3s ease;
        }

        .card:hover .chart-container {
            transform: scale(1.05);
        }

        .large {
            grid-column: span 2;
        }

        .full-width {
            grid-column: 1 / -1;
        }

        /* Stats Row */
        .stats-row {
            display: flex;
            justify-content: space-around;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e2e8f0;
        }

        .stat {
            text-align: center;
            transition: transform 0.3s ease;
        }

        .card:hover .stat {
            transform: translateY(-5px);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-blue);
            transition: all 0.3s ease;
        }

        .card:hover .stat-value {
            color: var(--dark-blue);
            transform: scale(1.1);
        }

        .stat-label {
            font-size: 0.85rem;
            color: #718096;
            margin-top: 5px;
        }

        /* Quote Cards */
        .quote-card {
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--white) 100%);
            border-left: 5px solid var(--accent-teal);
        }

        .quote-text {
            font-style: italic;
            color: var(--dark-blue);
            margin-bottom: 10px;
            line-height: 1.5;
        }

        .quote-author {
            text-align: right;
            color: var(--primary-blue);
            font-weight: 600;
        }

        /* Insights Cards */
        .insights-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid var(--warning-orange);
        }

        .insights-list {
            list-style-type: none;
            padding-left: 0;
        }

        .insights-list li {
            padding: 10px 0;
            border-bottom: 1px dashed #e2e8f0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .insights-list li:last-child {
            border-bottom: none;
        }

        .insights-list li i {
            color: var(--accent-teal);
            margin-top: 3px;
        }

        /* Solutions Cards */
        .solutions-card {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 5px solid var(--success-green);
        }

        .solutions-list {
            list-style-type: none;
            padding-left: 0;
        }

        .solutions-list li {
            padding: 10px 0;
            border-bottom: 1px dashed #e2e8f0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .solutions-list li:last-child {
            border-bottom: none;
        }

        .solutions-list li i {
            color: var(--success-green);
            margin-top: 3px;
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            color: white;
            margin: 40px 0 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .section-header h2 {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .section-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--dark-blue);
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #718096;
            transition: color 0.3s ease;
        }

        .close-modal:hover {
            color: var(--danger-red);
        }

        .share-options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .share-btn {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 15px;
            border-radius: 10px;
            border: none;
            background: var(--light-blue);
            color: var(--dark-blue);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .share-btn:hover {
            background: var(--primary-blue);
            color: white;
            transform: translateY(-2px);
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success-green);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 9999;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .toast.active {
            transform: translateY(0);
            opacity: 1;
        }

        .toast.error {
            background: var(--danger-red);
        }

        /* Progress Bars */
        .progress-container {
            margin: 20px 0;
        }

        .progress-bar {
            height: 10px;
            background: #e2e8f0;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-blue), var(--accent-teal));
            border-radius: 5px;
            position: relative;
            transition: width 1s ease;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
            animation: shimmer 2s infinite;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
        }

        /* Alert Boxes */
        .alert {
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-info {
            background: var(--light-blue);
            color: var(--dark-blue);
            border-left: 5px solid var(--primary-blue);
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 5px solid var(--success-green);
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left: 5px solid var(--warning-orange);
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.3);
            }
        }

        @keyframes shimmer {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Water Drops */
        .water-drop {
            position: absolute;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50% 50% 50% 0;
            transform: rotate(-45deg);
            animation: dropFall 5s linear infinite;
            z-index: -1;
        }

        @keyframes dropFall {
            0% {
                top: -20px;
                opacity: 1;
            }
            100% {
                top: 100vh;
                opacity: 0;
            }
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .grid {
                grid-template-columns: repeat(2, 1fr);
            }
            .large {
                grid-column: span 2;
            }
            .stats-dashboard {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            .large, .full-width {
                grid-column: span 1;
            }
            .header h1 {
                font-size: 1.8rem;
            }
            .controls, .report-nav {
                flex-direction: column;
                align-items: center;
            }
            .stats-dashboard {
                grid-template-columns: 1fr;
            }
        }

        /* Print Styles */
        @media print {
            .controls, .report-nav, .toast, .modal-overlay {
                display: none !important;
            }
            
            body {
                background: white !important;
                padding: 0;
            }
            
            .card {
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }
            
            .header {
                background: white !important;
                color: var(--dark-blue) !important;
            }
        }
    </style>
</head>
<body>
    <!-- Water Drops Background -->
    <div id="waterDrops"></div>

    <div class="dashboard">
        <div class="header">
            <div class="logo-container">
                <i class="fas fa-tint logo"></i>
                <h1>Water Wise Soweto Outreach</h1>
            </div>
            <h2>Final Report (Day 1 to Summit Completion)</h2>
            <p>The final Soweto outreach phase, spanning all groundwork days and culminating in the Water Wise Summit, achieved high participation and deep qualitative engagement. The data collection effort was robust, with strong community feedback and measurable insights on water usage, awareness, and conservation challenges.</p>
            <div class="date-badge">
                <span class="pulse-dot"></span>Data Sources: Household Surveys, Summit Feedback, Focus Groups
            </div>
            
            <div class="report-nav">
                <button class="nav-btn active" id="overviewBtn">
                    <i class="fas fa-chart-pie"></i>Overview
                    <span class="tooltip">View project summary and key metrics</span>
                </button>
                <button class="nav-btn" id="quantitativeBtn">
                    <i class="fas fa-chart-bar"></i>Quantitative Analysis
                    <span class="tooltip">Explore data-driven insights and trends</span>
                </button>
                <button class="nav-btn" id="qualitativeBtn">
                    <i class="fas fa-comments"></i>Qualitative Insights
                    <span class="tooltip">Read community voices and feedback</span>
                </button>
                <button class="nav-btn" id="recommendationsBtn">
                    <i class="fas fa-lightbulb"></i>Recommendations
                    <span class="tooltip">See evidence-based interventions</span>
                </button>
            </div>
            
            <div class="controls">
                <button class="control-btn" id="printBtn">
                    <i class="fas fa-print"></i>Print Report
                    <span class="tooltip">Print this report (Alt+P)</span>
                </button>
                <button class="control-btn" id="downloadBtn">
                    <i class="fas fa-download"></i>Download Data
                    <span class="tooltip">Download data as Excel (Alt+D)</span>
                </button>
                <button class="control-btn" id="shareBtn">
                    <i class="fas fa-share-alt"></i>Share Report
                    <span class="tooltip">Share this report with others</span>
                </button>
            </div>
        </div>

        <!-- Quick Stats Dashboard -->
        <div class="stats-dashboard">
            <div class="stat-card">
                <div class="stat-icon" style="color: var(--primary-blue);">
                    <i class="fas fa-users"></i>
                </div>
                <div class="stat-value" id="totalParticipants">0</div>
                <div class="stat-label">Total Participants</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="color: var(--success-green);">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
                <div class="stat-value" id="workshopInterest">0%</div>
                <div class="stat-label">Workshop Interest</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="color: var(--warning-orange);">
                    <i class="fas fa-clipboard-check"></i>
                </div>
                <div class="stat-value" id="surveysCompleted">0</div>
                <div class="stat-label">Surveys Completed</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon" style="color: var(--accent-teal);">
                    <i class="fas fa-tint"></i>
                </div>
                <div class="stat-value" id="waterConcern">0%</div>
                <div class="stat-label">Water Concern</div>
            </div>
        </div>

        <!-- Overview Section -->
        <div class="report-content" id="overviewReport">
            <div class="section-header">
                <h2><i class="fas fa-chart-pie"></i> Project Overview</h2>
                <p>Summary of the Soweto Water Wise Outreach Initiative</p>
            </div>

            <div class="grid">
                <div class="card large">
                    <div class="card-title">Project Timeline & Key Milestones</div>
                    <div class="chart-container">
                        <canvas id="timelineChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Data Collection Summary</div>
                    <div class="chart-container">
                        <canvas id="dataCollectionChart"></canvas>
                    </div>
                </div>

                <div class="card large">
                    <div class="card-title">Community Engagement Metrics</div>
                    <div class="chart-container">
                        <canvas id="engagementChart"></canvas>
                    </div>
                    <div class="stats-row">
                        <div class="stat">
                            <div class="stat-value">78%</div>
                            <div class="stat-label">Workshop Interest</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">80%</div>
                            <div class="stat-label">Water Concern</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">90%</div>
                            <div class="stat-label">Community Role Belief</div>
                        </div>
                    </div>
                </div>

                <div class="card full-width insights-card">
                    <div class="card-title">Key Project Achievements</div>
                    <ul class="insights-list">
                        <li><i class="fas fa-check-circle"></i> <strong>High Participation:</strong> Robust data collection across all outreach days with strong community engagement</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Deep Qualitative Insights:</strong> Captured authentic community voices and practical challenges</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Measurable Impact:</strong> Clear data-driven insights on water usage, awareness, and conservation challenges</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Trust Building:</strong> Established stronger connections between community and water authorities</li>
                        <li><i class="fas fa-check-circle"></i> <strong>Actionable Intelligence:</strong> Data-to-action pipeline for evidence-based interventions</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Quantitative Analysis Section -->
        <div class="report-content" id="quantitativeReport" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-chart-bar"></i> Quantitative Analysis</h2>
                <p>Data-driven insights and trends from household surveys</p>
            </div>

            <div class="grid">
                <div class="card">
                    <div class="card-title">Household Size Distribution</div>
                    <div class="chart-container">
                        <canvas id="householdChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Dwelling Types</div>
                    <div class="chart-container">
                        <canvas id="dwellingChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Property Ownership</div>
                    <div class="chart-container">
                        <canvas id="ownershipChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Water Meter Access</div>
                    <div class="chart-container">
                        <canvas id="meterChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Water Shortage Frequency</div>
                    <div class="chart-container">
                        <canvas id="shortageChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Infrastructure Rating</div>
                    <div class="chart-container">
                        <canvas id="infrastructureChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Water-Saving Devices Usage</div>
                    <div class="chart-container">
                        <canvas id="devicesChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Garden Watering Methods</div>
                    <div class="chart-container">
                        <canvas id="gardenChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">Water Conservation Education</div>
                    <div class="chart-container">
                        <canvas id="educationChart"></canvas>
                    </div>
                </div>

                <div class="card large">
                    <div class="card-title">Community Willingness & Engagement</div>
                    <div class="chart-container">
                        <canvas id="willingnessChart"></canvas>
                    </div>
                    <div class="stats-row">
                        <div class="stat">
                            <div class="stat-value">78%</div>
                            <div class="stat-label">Workshop Interest</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">75%</div>
                            <div class="stat-label">Adoption Willingness</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">60%</div>
                            <div class="stat-label">Reporting Knowledge Gap</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Qualitative Insights Section -->
        <div class="report-content" id="qualitativeReport" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-comments"></i> Qualitative Insights</h2>
                <p>Community voices, challenges, and summit feedback</p>
            </div>

            <div class="grid">
                <div class="card large quote-card">
                    <div class="card-title">Resident Voices - Key Challenges</div>
                    <div class="quote-text">
                        "We don't know when water will go. No one tells us."
                    </div>
                    <div class="quote-author">- Soweto Resident</div>
                    <div class="quote-text" style="margin-top: 15px;">
                        "Our meter doesn't work, and no one comes to fix it."
                    </div>
                    <div class="quote-author">- Soweto Resident</div>
                    <div class="quote-text" style="margin-top: 15px;">
                        "We wash food with grey water when there's no water."
                    </div>
                    <div class="quote-author">- Soweto Resident</div>
                </div>

                <div class="card">
                    <div class="card-title">Communication Gaps</div>
                    <div class="chart-container">
                        <canvas id="communicationChart"></canvas>
                    </div>
                </div>

                <div class="card large insights-card">
                    <div class="card-title">Key Challenges Identified</div>
                    <ul class="insights-list">
                        <li><i class="fas fa-exclamation-triangle"></i> <strong>Lack of communication</strong> on planned outages</li>
                        <li><i class="fas fa-tachometer-alt"></i> <strong>Broken or non-functional water meters</strong></li>
                        <li><i class="fas fa-recycle"></i> <strong>Reliance on greywater</strong> for cleaning and food washing</li>
                        <li><i class="fas fa-question-circle"></i> <strong>Limited knowledge</strong> of how or where to report leaks</li>
                        <li><i class="fas fa-phone-slash"></i> Preference for <strong>local community offices</strong> rather than only phone-based support</li>
                    </ul>
                </div>

                <div class="card large">
                    <div class="card-title">Water Wise Summit Insights</div>
                    <div class="chart-container">
                        <canvas id="summitChart"></canvas>
                    </div>
                </div>

                <div class="card full-width insights-card">
                    <div class="card-title">Summit Findings - Problems & Solutions</div>
                    <div class="grid" style="grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div>
                            <h3 style="color: var(--dark-blue); margin-bottom: 15px;">Problems Identified</h3>
                            <ul class="insights-list">
                                <li><i class="fas fa-trash"></i> Water pollution from waste dumping and litter</li>
                                <li><i class="fas fa-dumpster"></i> Lack of bins and sanitation infrastructure</li>
                                <li><i class="fas fa-ban"></i> Blockages due to improper disposal (pads, nappies, plastics)</li>
                                <li><i class="fas fa-tools"></i> Low technical capacity to address leaks and water quality</li>
                            </ul>
                        </div>
                        <div>
                            <h3 style="color: var(--dark-blue); margin-bottom: 15px;">Proposed Solutions</h3>
                            <ul class="insights-list">
                                <li><i class="fas fa-graduation-cap"></i> Upskilling locals in plumbing and water treatment</li>
                                <li><i class="fas fa-users"></i> Creating a "pool of plumbers" for rapid response</li>
                                <li><i class="fas fa-mobile-alt"></i> Report Leaks App integration</li>
                                <li><i class="fas fa-chalkboard-teacher"></i> Education workshops for youth and community groups</li>
                                <li><i class="fas fa-building"></i> Community reporting office for local issue handling</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Recommendations Section -->
        <div class="report-content" id="recommendationsReport" style="display: none;">
            <div class="section-header">
                <h2><i class="fas fa-lightbulb"></i> Recommendations & Next Steps</h2>
                <p>Evidence-based interventions for sustainable water management</p>
            </div>

            <div class="grid">
                <div class="card large solutions-card">
                    <div class="card-title">Key Recommendations</div>
                    <ul class="solutions-list">
                        <li><i class="fas fa-mobile-alt"></i> <strong>Launch the "Report Leaks App"</strong> with GIS tagging for faster response</li>
                        <li><i class="fas fa-wrench"></i> <strong>Build a Community Plumbing Network</strong> - creating local jobs + faster leak repair</li>
                        <li><i class="fas fa-chalkboard-teacher"></i> <strong>Design Educational Campaigns</strong> using real survey data insights</li>
                        <li><i class="fas fa-bullhorn"></i> <strong>Install community noticeboards or SMS alerts</strong> for planned outages</li>
                        <li><i class="fas fa-expand-arrows-alt"></i> <strong>Expand the Soweto model</strong> to Thembisa and Alexandra</li>
                        <li><i class="fas fa-chart-line"></i> <strong>Visualize insights in Power BI/Tableau</strong> for dynamic tracking</li>
                    </ul>
                </div>

                <div class="card">
                    <div class="card-title">Implementation Timeline</div>
                    <div class="chart-container">
                        <canvas id="implementationChart"></canvas>
                    </div>
                </div>

                <div class="card full-width">
                    <div class="card-title">Community Value Added</div>
                    <div class="quote-text">
                        This project built both trust and data â€” turning community voices into structured insights that guide water policy and outreach. By leveraging this data-to-action pipeline, Rand Water and Water Wise can make evidence-based interventions that are responsive, localized, and sustainable.
                    </div>
                    <div class="stats-row">
                        <div class="stat">
                            <div class="stat-value">Trust</div>
                            <div class="stat-label">Community Connection</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">Data</div>
                            <div class="stat-label">Structured Insights</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">Action</div>
                            <div class="stat-label">Evidence-Based Policy</div>
                        </div>
                    </div>
                </div>

                <div class="card large">
                    <div class="card-title">Expected Impact Metrics</div>
                    <div class="chart-container">
                        <canvas id="impactChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="modal-overlay" id="shareModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Share Report</h3>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>
            <div class="share-options">
                <button class="share-btn" id="emailShare">
                    <i class="fas fa-envelope"></i>
                    Share via Email
                </button>
                <button class="share-btn" id="whatsappShare">
                    <i class="fab fa-whatsapp"></i>
                    Share via WhatsApp
                </button>
                <button class="share-btn" id="copyLink">
                    <i class="fas fa-link"></i>
                    Copy Link
                </button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Action completed successfully!</span>
    </div>

    <script>
        // Color scheme
        const colors = {
            primary: ['#0066cc', '#0099ff', '#00cccc', '#004d99', '#008fb3', '#00b3b3'],
            gradient1: ['rgba(0, 102, 204, 0.8)', 'rgba(0, 153, 255, 0.8)'],
            gradient2: ['rgba(0, 204, 204, 0.8)', 'rgba(0, 179, 179, 0.8)']
        };

        // Store chart instances
        const chartInstances = {};

        // Initialize all charts when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeOverviewCharts();
            createWaterDrops();
            animateCounters();
            
            // Set up report navigation
            document.getElementById('overviewBtn').addEventListener('click', function() {
                switchReport('overview');
            });

            document.getElementById('quantitativeBtn').addEventListener('click', function() {
                switchReport('quantitative');
                if (!chartInstances.quantitativeInitialized) {
                    initializeQuantitativeCharts();
                    chartInstances.quantitativeInitialized = true;
                }
            });

            document.getElementById('qualitativeBtn').addEventListener('click', function() {
                switchReport('qualitative');
                if (!chartInstances.qualitativeInitialized) {
                    initializeQualitativeCharts();
                    chartInstances.qualitativeInitialized = true;
                }
            });

            document.getElementById('recommendationsBtn').addEventListener('click', function() {
                switchReport('recommendations');
                if (!chartInstances.recommendationsInitialized) {
                    initializeRecommendationsCharts();
                    chartInstances.recommendationsInitialized = true;
                }
            });

            // Set up export functionality
            document.getElementById('printBtn').addEventListener('click', function() {
                window.print();
            });

            document.getElementById('downloadBtn').addEventListener('click', downloadExcel);
            
            // Set up share modal
            document.getElementById('shareBtn').addEventListener('click', function() {
                document.getElementById('shareModal').classList.add('active');
            });
            
            document.getElementById('closeModal').addEventListener('click', function() {
                document.getElementById('shareModal').classList.remove('active');
            });
            
            // Set up share options
            document.getElementById('emailShare').addEventListener('click', function() {
                window.location.href = 'mailto:?subject=Water Wise Soweto Outreach Report&body=Check out this report: ' + window.location.href;
                showToast('Email link generated!');
                document.getElementById('shareModal').classList.remove('active');
            });
            
            document.getElementById('whatsappShare').addEventListener('click', function() {
                window.open('https://wa.me/?text=Check out this Water Wise Soweto Outreach Report: ' + window.location.href, '_blank');
                showToast('Opening WhatsApp...');
                document.getElementById('shareModal').classList.remove('active');
            });
            
            document.getElementById('copyLink').addEventListener('click', function() {
                navigator.clipboard.writeText(window.location.href).then(function() {
                    showToast('Link copied to clipboard!');
                    document.getElementById('shareModal').classList.remove('active');
                }, function() {
                    showToast('Failed to copy link', true);
                });
            });
            
            // Close modal when clicking outside
            document.getElementById('shareModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                if (e.altKey && e.key === 'p') {
                    e.preventDefault();
                    window.print();
                }
                
                if (e.altKey && e.key === 'd') {
                    e.preventDefault();
                    downloadExcel();
                }
            });
        });

        // Create water drops for background
        function createWaterDrops() {
            const container = document.getElementById('waterDrops');
            const dropCount = 15;
            
            for (let i = 0; i < dropCount; i++) {
                const drop = document.createElement('div');
                drop.className = 'water-drop';
                drop.style.left = Math.random() * 100 + 'vw';
                drop.style.animationDelay = Math.random() * 5 + 's';
                drop.style.width = (Math.random() * 10 + 5) + 'px';
                drop.style.height = (Math.random() * 10 + 5) + 'px';
                container.appendChild(drop);
            }
        }

        // Animated counters for stats
        function animateCounters() {
            const counters = [
                { element: 'totalParticipants', target: 292, suffix: '' },
                { element: 'workshopInterest', target: 78, suffix: '%' },
                { element: 'surveysCompleted', target: 67, suffix: '' },
                { element: 'waterConcern', target: 80, suffix: '%' }
            ];
            
            counters.forEach(counter => {
                const element = document.getElementById(counter.element);
                let current = 0;
                const increment = counter.target / 50;
                
                const updateCounter = () => {
                    if (current < counter.target) {
                        current += increment;
                        if (current > counter.target) current = counter.target;
                        element.textContent = Math.floor(current) + counter.suffix;
                        setTimeout(updateCounter, 30);
                    }
                };
                
                updateCounter();
            });
        }

        // Show toast notification
        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            const toastMessage = document.getElementById('toastMessage');
            
            toastMessage.textContent = message;
            
            if (isError) {
                toast.classList.add('error');
            } else {
                toast.classList.remove('error');
            }
            
            toast.classList.add('active');
            
            setTimeout(() => {
                toast.classList.remove('active');
            }, 3000);
        }

        // Initialize Overview Charts
        function initializeOverviewCharts() {
            createTimelineChart('timelineChart');
            createDataCollectionChart('dataCollectionChart');
            createEngagementChart('engagementChart');
        }

        // Initialize Quantitative Charts
        function initializeQuantitativeCharts() {
            createHouseholdChart('householdChart', [33.5, 25, 25, 16.5]);
            createDwellingChart('dwellingChart', [64.3, 19, 4.8, 11.9]);
            createOwnershipChart('ownershipChart', [50, 35.7, 14.3]);
            createMeterChart('meterChart', [59.5, 26.2, 14.3]);
            createShortageChart('shortageChart', [66.7, 19, 2.4, 11.9]);
            createInfrastructureChart('infrastructureChart', [21.4, 9.5, 21.4, 21.4, 7.1, 19]);
            createDevicesChart('devicesChart', [57.1, 11.9, 9.5, 7.1, 2.4, 11.9]);
            createGardenChart('gardenChart', [38.1, 26.2, 9.5, 7.1, 7.1, 11.9]);
            createEducationChart('educationChart', [38.1, 45.2, 4.8, 11.9]);
            createWillingnessChart('willingnessChart', [73.8, 7.1, 19]);
        }

        // Initialize Qualitative Charts
        function initializeQualitativeCharts() {
            createCommunicationChart('communicationChart');
            createSummitChart('summitChart');
        }

        // Initialize Recommendations Charts
        function initializeRecommendationsCharts() {
            createImplementationChart('implementationChart');
            createImpactChart('impactChart');
        }

        // Switch between reports
        function switchReport(reportType) {
            // Hide all reports
            document.querySelectorAll('.report-content').forEach(el => {
                el.style.display = 'none';
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Show selected report and activate button
            document.getElementById(reportType + 'Report').style.display = 'block';
            document.getElementById(reportType + 'Btn').classList.add('active');
            
            // Smooth scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Chart creation functions
        function createTimelineChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Summit'],
                    datasets: [{
                        label: 'Surveys Completed',
                        data: [12, 30, 25, 150],
                        backgroundColor: colors.primary[0],
                        borderRadius: 10
                    }, {
                        label: 'Community Engagement',
                        data: [45, 75, 80, 200],
                        backgroundColor: colors.primary[2],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Participants'
                            }
                        }
                    }
                }
            });
        }

        function createDataCollectionChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Household Surveys', 'Summit Feedback', 'Focus Groups', 'Observational Data'],
                    datasets: [{
                        data: [67, 150, 45, 30],
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createEngagementChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Workshop Interest', 'Water Concern', 'Community Role Belief', 'Willingness to Adopt'],
                    datasets: [{
                        data: [78, 80, 90, 75],
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createHouseholdChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['6 or more', '1 person', '4-5 people', '2-3 people'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createDwellingChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Brick house', 'Informal settlement', 'RDP house', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createOwnershipChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Own', 'Rent', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createMeterChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createShortageChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Occasionally', 'Frequently', 'Rarely', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createInfrastructureChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'polarArea',
                data: {
                    labels: ['Poor', 'Very poor', 'Fair', 'Good', 'Excellent', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary.map(c => c + 'CC')
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createDevicesChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Dual-flush toilet', 'Dual-flush + Low-flow', 'Low-flow showerhead', 'Dual-flush + Greywater', 'Greywater system', 'None/Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createGardenChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ["Don't water garden", 'Hosepipe', 'Not applicable', 'Bucket', 'Sprinkler', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createEducationChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No', 'Not sure', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createWillingnessChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Yes', 'Maybe', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createCommunicationChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Lack of outage info', 'Meter issues', 'Greywater reliance', 'Reporting knowledge gap', 'Prefer local offices'],
                    datasets: [{
                        label: 'Residents Reporting Issue',
                        data: [85, 70, 65, 60, 75],
                        backgroundColor: colors.primary[0],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createSummitChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Water pollution', 'Lack of bins', 'Blockages', 'Technical capacity'],
                    datasets: [{
                        label: 'Problems Identified',
                        data: [80, 75, 70, 65],
                        backgroundColor: colors.primary[1],
                        borderRadius: 10
                    }, {
                        label: 'Solutions Proposed',
                        data: [85, 80, 75, 90],
                        backgroundColor: colors.primary[2],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createImplementationChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024', 'Q1 2025'],
                    datasets: [{
                        label: 'Report Leaks App',
                        data: [10, 40, 70, 90, 100],
                        borderColor: colors.primary[0],
                        backgroundColor: colors.primary[0] + '20',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Community Plumbing Network',
                        data: [5, 25, 60, 85, 95],
                        borderColor: colors.primary[1],
                        backgroundColor: colors.primary[1] + '20',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Education Campaigns',
                        data: [15, 45, 75, 90, 100],
                        borderColor: colors.primary[2],
                        backgroundColor: colors.primary[2] + '20',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createImpactChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Leak Reporting', 'Response Time', 'Water Conservation', 'Community Engagement', 'Infrastructure Rating'],
                    datasets: [{
                        label: 'Current',
                        data: [30, 40, 45, 65, 50],
                        backgroundColor: colors.primary[0],
                        borderRadius: 5
                    }, {
                        label: 'Target (12 months)',
                        data: [80, 75, 70, 85, 75],
                        backgroundColor: colors.primary[2],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        // Download Excel functionality
        function downloadExcel() {
            // Create data for Excel format
            const data = [
                ['Water Wise Soweto Outreach - Final Report Data', '', '', ''],
                ['', '', '', ''],
                ['Quantitative Analysis Summary', '', '', ''],
                ['Metric', 'Value', 'Insight', ''],
                ['Household Size (4-5 people)', '25%', 'Average household size', ''],
                ['Brick House Dwellings', '64.3%', 'Majority housing type', ''],
                ['Property Ownership', '50%', 'Half of residents own their property', ''],
                ['Water Meter Access', '59.5%', 'Significant portion lack functional meters', ''],
                ['Water Shortages (Occasionally)', '66.7%', 'Most experience regular shortages', ''],
                ['Infrastructure Rating (Fair)', '21.4%', 'Infrastructure generally rated as fair', ''],
                ['Water-Saving Devices', '15-20%', 'Low adoption of water-saving technology', ''],
                ['Water Conservation Education', '45%', 'Less than half received education', ''],
                ['Workshop Interest', '78%', 'Strong community interest in workshops', ''],
                ['Willingness to Adopt', '75%', 'High willingness to adopt water-saving practices', ''],
                ['', '', '', ''],
                ['Qualitative Insights Summary', '', '', ''],
                ['Challenge', 'Impact', 'Resident Quote', ''],
                ['Lack of Communication', 'High', '"We don\'t know when water will go. No one tells us."', ''],
                ['Non-functional Meters', 'Medium-High', '"Our meter doesn\'t work, and no one comes to fix it."', ''],
                ['Greywater Reliance', 'Medium', '"We wash food with grey water when there\'s no water."', ''],
                ['Reporting Knowledge Gap', 'High', 'Over 60% didn\'t know how to report leaks', ''],
                ['Preference for Local Support', 'Medium', 'Residents prefer local offices over phone support', '']
            ];

            // Create worksheet
            const ws = XLSX.utils.aoa_to_sheet(data);
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Soweto Final Report");
            
            // Generate XLSX file and trigger download
            XLSX.writeFile(wb, "Water_Wise_Soweto_Final_Report.xlsx");
            
            // Show success toast
            showToast('Data downloaded successfully!');
        }
    </script>
</body>
</html>



















<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Water Wise Soweto Outreach - Final Report</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="assets/randwaterLogo.jpg" type="image/x-icon">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-blue: #0066cc;
            --secondary-blue: #0099ff;
            --light-blue: #e6f2ff;
            --dark-blue: #004d99;
            --accent-teal: #00cccc;
            --white: #ffffff;
            --light-gray: #f5f7fa;
            --text-dark: #333333;
            --success-green: #28a745;
            --warning-orange: #ffc107;
            --danger-red: #dc3545;
        }

        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%);
            min-height: 100vh;
            overflow-x: hidden;
            color: var(--text-dark);
            line-height: 1.6;
            position: relative;
        }

        /* Water Droplets Background Animation */
        .water-drop {
            position: fixed;
            top: -10%;
            width: 15px;
            height: 15px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50% 50% 50% 0;
            transform: rotate(45deg);
            animation: fall linear infinite;
            pointer-events: none;
            z-index: 1;
        }

        @keyframes fall {
            to {
                top: 110%;
                opacity: 0;
            }
        }

        .dashboard {
            position: relative;
            z-index: 2;
        }

        /* Header Section */
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            position: relative;
            padding: 40px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo {
            font-size: 3rem;
            color: white;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .header h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
            animation: slideInDown 0.8s ease-out;
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .header h2 {
            font-size: 1.5rem;
            font-weight: 500;
            opacity: 0.9;
            margin-bottom: 15px;
            animation: slideInDown 0.8s ease-out 0.2s both;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            animation: slideInDown 0.8s ease-out 0.4s both;
        }

        .date-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin-top: 10px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            animation: slideInDown 0.8s ease-out 0.6s both;
        }

        .pulse-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #4ade80;
            border-radius: 50%;
            margin-right: 8px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                opacity: 1;
                transform: scale(1);
            }
            50% {
                opacity: 0.5;
                transform: scale(1.3);
            }
        }

        /* Quick Stats Dashboard */
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(255, 255, 255, 0.5);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s;
        }

        .stat-card:hover::before {
            left: 100%;
        }

        .stat-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .stat-card.primary .stat-icon { color: var(--primary-blue); }
        .stat-card.success .stat-icon { color: var(--success-green); }
        .stat-card.warning .stat-icon { color: var(--warning-orange); }
        .stat-card.info .stat-icon { color: var(--accent-teal); }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 5px;
            font-variant-numeric: tabular-nums;
        }

        .stat-label {
            font-size: 0.95rem;
            color: #718096;
            font-weight: 500;
        }

        .progress-bar-shimmer {
            position: relative;
            overflow: hidden;
        }

        .progress-bar-shimmer::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            to {
                left: 100%;
            }
        }

        /* Bootstrap Nav Pills Enhancement */
        .nav-pills .nav-link {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            margin: 0 5px;
        }

        .nav-pills .nav-link:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .nav-pills .nav-link.active {
            background: rgba(255, 255, 255, 0.3) !important;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        /* Tooltip Enhancement */
        .tooltip-inner {
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 8px;
            padding: 8px 12px;
        }

        /* Cards Enhancement */
        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0, 102, 204, 0.1), transparent);
            transition: left 0.5s;
        }

        .card:hover::before {
            left: 100%;
        }

        .card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            padding-bottom: 10px;
        }

        .card-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50px;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-blue), var(--accent-teal));
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .card:hover .card-title::after {
            width: 80%;
        }

        /* Badge Enhancement */
        .badge {
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }

        /* Alert Boxes */
        .alert {
            border-radius: 15px;
            border: none;
            backdrop-filter: blur(10px);
        }

        /* Toast Notification */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999;
        }

        .toast {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .toast-success {
            border-left: 5px solid var(--success-green);
        }

        /* Modal Enhancement */
        .modal-content {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .modal-header {
            border-bottom: 1px solid rgba(0, 102, 204, 0.2);
        }

        .modal-footer {
            border-top: 1px solid rgba(0, 102, 204, 0.2);
        }

        /* Button Enhancements */
        .btn-custom {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 20px;
            border-radius: 30px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-custom:hover {
            background: rgba(255, 255, 255, 0.3);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .btn-custom:focus {
            outline: 3px solid rgba(255, 255, 255, 0.5);
            outline-offset: 2px;
        }

        /* Chart Container */
        .chart-container {
            position: relative;
            height: 250px;
            transition: transform 0.3s ease;
        }

        .card:hover .chart-container {
            transform: scale(1.05);
        }

        /* Keyboard Navigation */
        *:focus-visible {
            outline: 3px solid rgba(0, 204, 204, 0.8);
            outline-offset: 2px;
        }

        /* Quote and Insights Cards */
        .quote-card {
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--white) 100%);
            border-left: 5px solid var(--accent-teal);
        }

        .insights-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid var(--warning-orange);
        }

        .solutions-card {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-left: 5px solid var(--success-green);
        }

        .insights-list, .solutions-list {
            list-style-type: none;
            padding-left: 0;
        }

        .insights-list li, .solutions-list li {
            padding: 10px 0;
            border-bottom: 1px dashed #e2e8f0;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }

        .insights-list li:last-child, .solutions-list li:last-child {
            border-bottom: none;
        }

        /* Section Headers */
        .section-header {
            text-align: center;
            color: white;
            margin: 40px 0 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
            }
            .btn-custom, .nav-pills, .toast-container, .water-drop {
                display: none !important;
            }
            .card {
                break-inside: avoid;
                page-break-inside: avoid;
            }
        }

        /* Skeleton Loader */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .header h1 { font-size: 1.8rem; }
            .stat-value { font-size: 2rem; }
            .quick-stats {
                grid-template-columns: 1fr;
            }
        }

        /* NEW ENHANCEMENTS */

        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-blue);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .fab:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        /* Dark Mode Toggle */
        .dark-mode-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        /* Data Filter Controls */
        .filter-controls {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Interactive Map */
        .map-container {
            height: 400px;
            border-radius: 15px;
            overflow: hidden;
            background: var(--light-blue);
            position: relative;
        }

        /* Timeline Component */
        .timeline {
            position: relative;
            max-width: 1200px;
            margin: 0 auto;
        }

        .timeline::after {
            content: '';
            position: absolute;
            width: 6px;
            background-color: var(--primary-blue);
            top: 0;
            bottom: 0;
            left: 50%;
            margin-left: -3px;
        }

        /* Data Table Enhancement */
        .data-table {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .data-table th {
            background: var(--primary-blue);
            color: white;
            font-weight: 600;
        }

        /* Chart Export Controls */
        .chart-export {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
        }

        /* Progress Tracking */
        .progress-tracking {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        /* Interactive Legend */
        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        .legend-color {
            width: 15px;
            height: 15px;
            border-radius: 3px;
        }

        /* Enhanced Tooltips */
        .enhanced-tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.9rem;
            pointer-events: none;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }

        /* Loading Spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 102, 204, 0.3);
            border-left: 4px solid var(--primary-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger-red);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Wave Animation */
        .wave {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120" preserveAspectRatio="none"><path d="M0,0V46.29c47.79,22.2,103.59,32.17,158,28,70.36-5.37,136.33-33.31,206.8-37.5C438.64,32.43,512.34,53.67,583,72.05c69.27,18,138.3,24.88,209.4,13.08,36.15-6,69.85-17.84,104.45-29.34C989.49,25,1113-14.29,1200,52.47V0Z" opacity=".25" fill="%230066cc"/><path d="M0,0V15.81C13,36.92,27.64,56.86,47.69,72.05,99.41,111.27,165,111,224.58,91.58c31.15-10.15,60.09-26.07,89.67-39.8,40.92-19,84.73-46,130.83-49.67,36.26-2.85,70.9,9.42,98.6,31.56,31.77,25.39,62.32,62,103.63,73,40.44,10.79,81.35-6.69,119.13-24.28s75.16-39,116.92-43.05c59.73-5.85,113.28,22.88,168.9,38.84,30.2,8.66,59,6.17,87.09-7.5,22.43-10.89,48-26.93,60.65-49.24V0Z" opacity=".5" fill="%230066cc"/><path d="M0,0V5.63C149.93,59,314.09,71.32,475.83,42.57c43-7.64,84.23-20.12,127.61-26.46,59-8.63,112.48,12.24,165.56,35.4C827.93,77.22,886,95.24,951.2,90c86.53-7,172.46-45.71,248.8-84.81V0Z" fill="%230066cc"/></svg>');
            background-size: cover;
            animation: wave 10s linear infinite;
        }

        @keyframes wave {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100px); }
        }

        /* Interactive Data Points */
        .data-point {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: var(--accent-teal);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .data-point:hover {
            transform: scale(1.5);
            box-shadow: 0 0 10px var(--accent-teal);
        }

        /* Comparison Slider */
        .comparison-slider {
            position: relative;
            width: 100%;
            height: 400px;
            border-radius: 15px;
            overflow: hidden;
        }

        .comparison-slider img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
        }

        .slider-handle {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 4px;
            background: white;
            cursor: col-resize;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <!-- Water Droplets Background -->
    <div id="waterDrops"></div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Dark Mode Toggle -->
    <div class="dark-mode-toggle">
        <button class="btn btn-custom" id="darkModeToggle" data-bs-toggle="tooltip" title="Toggle Dark Mode">
            <i class="fas fa-moon"></i>
        </button>
    </div>

    <!-- Floating Action Button -->
    <div class="fab" id="fab" data-bs-toggle="tooltip" title="Quick Actions">
        <i class="fas fa-bolt"></i>
    </div>

    <div class="dashboard container-fluid py-4">
        <div class="header">
            <div class="logo-container">
                <i class="fas fa-tint logo"></i>
                <h1>Water Wise Soweto Outreach</h1>
            </div>
            <h2>Final Report (Day 1 to Summit Completion)</h2>
            <p>The final Soweto outreach phase, spanning all groundwork days and culminating in the Water Wise Summit, achieved high participation and deep qualitative engagement. The data collection effort was robust, with strong community feedback and measurable insights on water usage, awareness, and conservation challenges.</p>
            <div class="date-badge">
                <span class="pulse-dot"></span>Data Sources: Household Surveys, Summit Feedback, Focus Groups
            </div>
            
            <!-- Bootstrap Nav Pills -->
            <ul class="nav nav-pills justify-content-center mt-4 mb-3 flex-wrap" id="reportTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="overview-tab" data-bs-toggle="pill" data-bs-target="#overview" type="button" role="tab" aria-controls="overview" aria-selected="true" data-bs-toggle="tooltip" title="View project overview and key achievements">
                        <i class="fas fa-chart-pie"></i> Overview
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="quantitative-tab" data-bs-toggle="pill" data-bs-target="#quantitative" type="button" role="tab" aria-controls="quantitative" aria-selected="false" data-bs-toggle="tooltip" title="Explore data-driven insights and trends">
                        <i class="fas fa-chart-bar"></i> Quantitative
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="qualitative-tab" data-bs-toggle="pill" data-bs-target="#qualitative" type="button" role="tab" aria-controls="qualitative" aria-selected="false" data-bs-toggle="tooltip" title="Read community voices and feedback">
                        <i class="fas fa-comments"></i> Qualitative
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="recommendations-tab" data-bs-toggle="pill" data-bs-target="#recommendations" type="button" role="tab" aria-controls="recommendations" aria-selected="false" data-bs-toggle="tooltip" title="View actionable recommendations">
                        <i class="fas fa-lightbulb"></i> Recommendations
                    </button>
                </li>
            </ul>
            
            <div class="d-flex justify-content-center gap-3 flex-wrap mt-3">
                <button class="btn btn-custom" id="printBtn" data-bs-toggle="tooltip" title="Print this report (Alt+P)">
                    <i class="fas fa-print"></i> Print Report
                </button>
                <button class="btn btn-custom" id="downloadBtn" data-bs-toggle="tooltip" title="Download data as Excel (Alt+D)">
                    <i class="fas fa-download"></i> Download Data
                </button>
                <button class="btn btn-custom" id="shareBtn" data-bs-toggle="modal" data-bs-target="#shareModal" data-bs-toggle="tooltip" title="Share this report">
                    <i class="fas fa-share-alt"></i> Share Report
                </button>
            </div>
        </div>

        <!-- Quick Stats Dashboard -->
        <div class="quick-stats">
            <div class="stat-card primary">
                <div class="stat-icon"><i class="fas fa-users"></i></div>
                <div class="stat-value" data-target="292">0</div>
                <div class="stat-label">Total Participants</div>
                <div class="progress mt-2 progress-bar-shimmer">
                    <div class="progress-bar bg-primary" style="width: 100%"></div>
                </div>
            </div>
            <div class="stat-card success">
                <div class="stat-icon"><i class="fas fa-graduation-cap"></i></div>
                <div class="stat-value" data-target="78">0</div>
                <div class="stat-label">Workshop Interest (%)</div>
                <div class="progress mt-2 progress-bar-shimmer">
                    <div class="progress-bar bg-success" style="width: 78%"></div>
                </div>
            </div>
            <div class="stat-card warning">
                <div class="stat-icon"><i class="fas fa-clipboard-list"></i></div>
                <div class="stat-value" data-target="67">0</div>
                <div class="stat-label">Surveys Completed</div>
                <div class="progress mt-2 progress-bar-shimmer">
                    <div class="progress-bar bg-warning" style="width: 67%"></div>
                </div>
            </div>
            <div class="stat-card info">
                <div class="stat-icon"><i class="fas fa-water"></i></div>
                <div class="stat-value" data-target="80">0</div>
                <div class="stat-label">Water Concern (%)</div>
                <div class="progress mt-2 progress-bar-shimmer">
                    <div class="progress-bar bg-info" style="width: 80%"></div>
                </div>
            </div>
        </div>

        <!-- Tab Content -->
        <div class="tab-content" id="reportTabContent">
            <!-- Overview Tab -->
            <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
                <div class="section-header">
                    <h2><i class="fas fa-chart-pie"></i> Project Overview</h2>
                    <p>Summary of the Soweto Water Wise Outreach Initiative</p>
                </div>

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Project Timeline & Key Milestones</div>
                                <div class="chart-container">
                                    <canvas id="timelineChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('timelineChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Data Collection Summary</div>
                                <div class="chart-container">
                                    <canvas id="dataCollectionChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('dataCollectionChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Community Engagement Metrics</div>
                                <div class="chart-container">
                                    <canvas id="engagementChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('engagementChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row text-center mt-3 pt-3 border-top">
                                    <div class="col-4">
                                        <div class="stat-value text-primary">78%</div>
                                        <div class="stat-label">Workshop Interest</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">80%</div>
                                        <div class="stat-label">Water Concern</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">90%</div>
                                        <div class="stat-label">Community Role Belief</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="card insights-card">
                            <div class="card-body">
                                <div class="card-title">Key Project Achievements</div>
                                <ul class="insights-list">
                                    <li><i class="fas fa-check-circle"></i> <strong>High Participation:</strong> Robust data collection across all outreach days with strong community engagement</li>
                                    <li><i class="fas fa-check-circle"></i> <strong>Deep Qualitative Insights:</strong> Captured authentic community voices and practical challenges</li>
                                    <li><i class="fas fa-check-circle"></i> <strong>Measurable Impact:</strong> Clear data-driven insights on water usage, awareness, and conservation challenges</li>
                                    <li><i class="fas fa-check-circle"></i> <strong>Trust Building:</strong> Established stronger connections between community and water authorities</li>
                                    <li><i class="fas fa-check-circle"></i> <strong>Actionable Intelligence:</strong> Data-to-action pipeline for evidence-based interventions</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quantitative Tab -->
            <div class="tab-pane fade" id="quantitative" role="tabpanel" aria-labelledby="quantitative-tab">
                <div class="section-header">
                    <h2><i class="fas fa-chart-bar"></i> Quantitative Analysis</h2>
                    <p>Data-driven insights and trends from household surveys</p>
                </div>

                <!-- Filter Controls -->
                <div class="filter-controls">
                    <div class="row g-3">
                        <div class="col-md-4">
                            <label class="form-label text-white">Filter by Area</label>
                            <select class="form-select" id="areaFilter">
                                <option value="all">All Areas</option>
                                <option value="soweto">Soweto Central</option>
                                <option value="soweto-east">Soweto East</option>
                                <option value="soweto-west">Soweto West</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label text-white">Filter by Date Range</label>
                            <select class="form-select" id="dateFilter">
                                <option value="all">All Dates</option>
                                <option value="week1">Week 1</option>
                                <option value="week2">Week 2</option>
                                <option value="week3">Week 3</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label class="form-label text-white">Data Type</label>
                            <select class="form-select" id="dataTypeFilter">
                                <option value="all">All Data</option>
                                <option value="surveys">Surveys Only</option>
                                <option value="interviews">Interviews Only</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="row g-4">
                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Household Size Distribution</div>
                                <div class="chart-container">
                                    <canvas id="householdChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('householdChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Dwelling Types</div>
                                <div class="chart-container">
                                    <canvas id="dwellingChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('dwellingChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Property Ownership</div>
                                <div class="chart-container">
                                    <canvas id="ownershipChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('ownershipChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water Meter Access</div>
                                <div class="chart-container">
                                    <canvas id="meterChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('meterChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water Shortage Frequency</div>
                                <div class="chart-container">
                                    <canvas id="shortageChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('shortageChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Infrastructure Rating</div>
                                <div class="chart-container">
                                    <canvas id="infrastructureChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('infrastructureChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water-Saving Devices Usage</div>
                                <div class="chart-container">
                                    <canvas id="devicesChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('devicesChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Garden Watering Methods</div>
                                <div class="chart-container">
                                    <canvas id="gardenChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('gardenChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-6 col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water Conservation Education</div>
                                <div class="chart-container">
                                    <canvas id="educationChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('educationChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Community Willingness & Engagement</div>
                                <div class="chart-container">
                                    <canvas id="willingnessChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('willingnessChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="row text-center mt-3 pt-3 border-top">
                                    <div class="col-4">
                                        <div class="stat-value text-primary">78%</div>
                                        <div class="stat-label">Workshop Interest</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">75%</div>
                                        <div class="stat-label">Adoption Willingness</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">60%</div>
                                        <div class="stat-label">Reporting Knowledge Gap</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Qualitative Tab -->
            <div class="tab-pane fade" id="qualitative" role="tabpanel" aria-labelledby="qualitative-tab">
                <div class="section-header">
                    <h2><i class="fas fa-comments"></i> Qualitative Insights</h2>
                    <p>Community voices, challenges, and summit feedback</p>
                </div>

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card quote-card">
                            <div class="card-body">
                                <div class="card-title">Resident Voices - Key Challenges</div>
                                <div class="quote-text">
                                    "We don't know when water will go. No one tells us."
                                </div>
                                <div class="quote-author">- Soweto Resident</div>
                                <div class="quote-text" style="margin-top: 15px;">
                                    "Our meter doesn't work, and no one comes to fix it."
                                </div>
                                <div class="quote-author">- Soweto Resident</div>
                                <div class="quote-text" style="margin-top: 15px;">
                                    "We wash food with grey water when there's no water."
                                </div>
                                <div class="quote-author">- Soweto Resident</div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Communication Gaps</div>
                                <div class="chart-container">
                                    <canvas id="communicationChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('communicationChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card insights-card">
                            <div class="card-body">
                                <div class="card-title">Key Challenges Identified</div>
                                <ul class="insights-list">
                                    <li><i class="fas fa-exclamation-triangle"></i> <strong>Lack of communication</strong> on planned outages</li>
                                    <li><i class="fas fa-tachometer-alt"></i> <strong>Broken or non-functional water meters</strong></li>
                                    <li><i class="fas fa-recycle"></i> <strong>Reliance on greywater</strong> for cleaning and food washing</li>
                                    <li><i class="fas fa-question-circle"></i> <strong>Limited knowledge</strong> of how or where to report leaks</li>
                                    <li><i class="fas fa-phone-slash"></i> Preference for <strong>local community offices</strong> rather than only phone-based support</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Water Wise Summit Insights</div>
                                <div class="chart-container">
                                    <canvas id="summitChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('summitChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="card insights-card">
                            <div class="card-body">
                                <div class="card-title">Summit Findings - Problems & Solutions</div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <h3 style="color: var(--dark-blue); margin-bottom: 15px;">Problems Identified</h3>
                                        <ul class="insights-list">
                                            <li><i class="fas fa-trash"></i> Water pollution from waste dumping and litter</li>
                                            <li><i class="fas fa-dumpster"></i> Lack of bins and sanitation infrastructure</li>
                                            <li><i class="fas fa-ban"></i> Blockages due to improper disposal (pads, nappies, plastics)</li>
                                            <li><i class="fas fa-tools"></i> Low technical capacity to address leaks and water quality</li>
                                        </ul>
                                    </div>
                                    <div class="col-md-6">
                                        <h3 style="color: var(--dark-blue); margin-bottom: 15px;">Proposed Solutions</h3>
                                        <ul class="insights-list">
                                            <li><i class="fas fa-graduation-cap"></i> Upskilling locals in plumbing and water treatment</li>
                                            <li><i class="fas fa-users"></i> Creating a "pool of plumbers" for rapid response</li>
                                            <li><i class="fas fa-mobile-alt"></i> Report Leaks App integration</li>
                                            <li><i class="fas fa-chalkboard-teacher"></i> Education workshops for youth and community groups</li>
                                            <li><i class="fas fa-building"></i> Community reporting office for local issue handling</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recommendations Tab -->
            <div class="tab-pane fade" id="recommendations" role="tabpanel" aria-labelledby="recommendations-tab">
                <div class="section-header">
                    <h2><i class="fas fa-lightbulb"></i> Recommendations & Next Steps</h2>
                    <p>Evidence-based interventions for sustainable water management</p>
                </div>

                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="card solutions-card">
                            <div class="card-body">
                                <div class="card-title">Key Recommendations</div>
                                <ul class="solutions-list">
                                    <li><i class="fas fa-mobile-alt"></i> <strong>Launch the "Report Leaks App"</strong> with GIS tagging for faster response</li>
                                    <li><i class="fas fa-wrench"></i> <strong>Build a Community Plumbing Network</strong> - creating local jobs + faster leak repair</li>
                                    <li><i class="fas fa-chalkboard-teacher"></i> <strong>Design Educational Campaigns</strong> using real survey data insights</li>
                                    <li><i class="fas fa-bullhorn"></i> <strong>Install community noticeboards or SMS alerts</strong> for planned outages</li>
                                    <li><i class="fas fa-expand-arrows-alt"></i> <strong>Expand the Soweto model</strong> to Thembisa and Alexandra</li>
                                    <li><i class="fas fa-chart-line"></i> <strong>Visualize insights in Power BI/Tableau</strong> for dynamic tracking</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-4">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Implementation Timeline</div>
                                <div class="chart-container">
                                    <canvas id="implementationChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('implementationChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Community Value Added</div>
                                <div class="quote-text">
                                    This project built both trust and data â€” turning community voices into structured insights that guide water policy and outreach. By leveraging this data-to-action pipeline, Rand Water and Water Wise can make evidence-based interventions that are responsive, localized, and sustainable.
                                </div>
                                <div class="row text-center mt-3 pt-3 border-top">
                                    <div class="col-4">
                                        <div class="stat-value text-primary">Trust</div>
                                        <div class="stat-label">Community Connection</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">Data</div>
                                        <div class="stat-label">Structured Insights</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="stat-value text-primary">Action</div>
                                        <div class="stat-label">Evidence-Based Policy</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-8">
                        <div class="card">
                            <div class="card-body">
                                <div class="card-title">Expected Impact Metrics</div>
                                <div class="chart-container">
                                    <canvas id="impactChart"></canvas>
                                    <div class="chart-export">
                                        <button class="btn btn-sm btn-outline-primary" onclick="exportChart('impactChart')">
                                            <i class="fas fa-download"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div class="modal fade" id="shareModal" tabindex="-1" aria-labelledby="shareModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="shareModalLabel"><i class="fas fa-share-alt"></i> Share Report</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p class="text-muted">Share this report with your team and stakeholders</p>
                    <div class="d-grid gap-3">
                        <button class="btn btn-outline-primary btn-lg" onclick="shareViaEmail()">
                            <i class="fas fa-envelope"></i> Share via Email
                        </button>
                        <button class="btn btn-outline-success btn-lg" onclick="shareViaWhatsApp()">
                            <i class="fab fa-whatsapp"></i> Share via WhatsApp
                        </button>
                        <button class="btn btn-outline-secondary btn-lg" onclick="copyLink()">
                            <i class="fas fa-link"></i> Copy Link
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- FAB Menu -->
    <div class="modal fade" id="fabMenu" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Quick Actions</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="d-grid gap-2">
                        <button class="btn btn-outline-primary" onclick="scrollToTop()">
                            <i class="fas fa-arrow-up"></i> Scroll to Top
                        </button>
                        <button class="btn btn-outline-success" onclick="toggleFullScreen()">
                            <i class="fas fa-expand"></i> Toggle Fullscreen
                        </button>
                        <button class="btn btn-outline-info" onclick="toggleDataLabels()">
                            <i class="fas fa-chart-bar"></i> Toggle Data Labels
                        </button>
                        <button class="btn btn-outline-warning" onclick="resetFilters()">
                            <i class="fas fa-filter"></i> Reset Filters
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Color scheme
        const colors = {
            primary: ['#0066cc', '#0099ff', '#00cccc', '#004d99', '#008fb3', '#00b3b3'],
            gradient1: ['rgba(0, 102, 204, 0.8)', 'rgba(0, 153, 255, 0.8)'],
            gradient2: ['rgba(0, 204, 204, 0.8)', 'rgba(0, 179, 179, 0.8)']
        };

        // Store chart instances
        const chartInstances = {};

        // Create water droplets
        function createWaterDrops() {
            const container = document.getElementById('waterDrops');
            for (let i = 0; i < 15; i++) {
                const drop = document.createElement('div');
                drop.className = 'water-drop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.animationDuration = (Math.random() * 3 + 2) + 's';
                drop.style.animationDelay = Math.random() * 5 + 's';
                container.appendChild(drop);
            }
        }

        // Animated counter
        function animateCounter(element) {
            const target = parseInt(element.getAttribute('data-target'));
            const duration = 2000;
            const step = target / (duration / 16);
            let current = 0;

            const timer = setInterval(() => {
                current += step;
                if (current >= target) {
                    element.textContent = target + (element.textContent.includes('%') ? '%' : '');
                    clearInterval(timer);
                } else {
                    element.textContent = Math.floor(current) + (element.textContent.includes('%') ? '%' : '');
                }
            }, 16);
        }

        // Toast notification
        function showToast(message, type = 'success') {
            const toastHTML = `
                <div class="toast toast-${type} show" role="alert" aria-live="assertive" aria-atomic="true">
                    <div class="toast-header">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'} me-2"></i>
                        <strong class="me-auto">Notification</strong>
                        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
                    </div>
                    <div class="toast-body">${message}</div>
                </div>
            `;
            
            const container = document.getElementById('toastContainer');
            container.insertAdjacentHTML('beforeend', toastHTML);
            
            setTimeout(() => {
                const toasts = container.querySelectorAll('.toast');
                if (toasts.length > 0) {
                    toasts[0].remove();
                }
            }, 3000);
        }

        // Share functions
        function shareViaEmail() {
            const subject = encodeURIComponent('Water Wise Soweto Outreach - Final Report');
            const body = encodeURIComponent('Check out the Water Wise Soweto Outreach Final Report: ' + window.location.href);
            window.location.href = `mailto:?subject=${subject}&body=${body}`;
            showToast('Opening email client...');
        }

        function shareViaWhatsApp() {
            const text = encodeURIComponent('Check out the Water Wise Soweto Outreach Final Report: ' + window.location.href);
            window.open(`https://wa.me/?text=${text}`, '_blank');
            showToast('Opening WhatsApp...');
        }

        function copyLink() {
            navigator.clipboard.writeText(window.location.href).then(() => {
                showToast('Link copied to clipboard!');
            }).catch(() => {
                showToast('Failed to copy link', 'error');
            });
        }

        // NEW ENHANCEMENT FUNCTIONS

        // Dark Mode Toggle
        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            const icon = document.querySelector('#darkModeToggle i');
            if (document.body.classList.contains('dark-mode')) {
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
                document.body.style.background = 'linear-gradient(135deg, #1a1a2e 0%, #16213e 100%)';
            } else {
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
                document.body.style.background = 'linear-gradient(135deg, var(--primary-blue) 0%, var(--secondary-blue) 100%)';
            }
        }

        // Chart Export
        function exportChart(chartId) {
            const chart = chartInstances[chartId];
            if (chart) {
                const link = document.createElement('a');
                link.download = `${chartId}.png`;
                link.href = chart.toBase64Image();
                link.click();
                showToast(`Chart ${chartId} exported successfully!`);
            }
        }

        // FAB Menu
        function openFabMenu() {
            const fabMenu = new bootstrap.Modal(document.getElementById('fabMenu'));
            fabMenu.show();
        }

        // Scroll to Top
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
            bootstrap.Modal.getInstance(document.getElementById('fabMenu')).hide();
        }

        // Toggle Fullscreen
        function toggleFullScreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
            bootstrap.Modal.getInstance(document.getElementById('fabMenu')).hide();
        }

        // Toggle Data Labels
        function toggleDataLabels() {
            Object.values(chartInstances).forEach(chart => {
                if (chart.options.plugins.datalabels) {
                    chart.options.plugins.datalabels.display = !chart.options.plugins.datalabels.display;
                } else {
                    if (!chart.options.plugins) chart.options.plugins = {};
                    chart.options.plugins.datalabels = { display: true };
                }
                chart.update();
            });
            bootstrap.Modal.getInstance(document.getElementById('fabMenu')).hide();
            showToast('Data labels toggled');
        }

        // Reset Filters
        function resetFilters() {
            document.getElementById('areaFilter').value = 'all';
            document.getElementById('dateFilter').value = 'all';
            document.getElementById('dataTypeFilter').value = 'all';
            bootstrap.Modal.getInstance(document.getElementById('fabMenu')).hide();
            showToast('Filters reset to default');
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.altKey && e.key === 'p') {
                e.preventDefault();
                window.print();
            }
            if (e.altKey && e.key === 'd') {
                e.preventDefault();
                downloadExcel();
            }
            if (e.altKey && e.key === 'm') {
                e.preventDefault();
                toggleDarkMode();
            }
            if (e.altKey && e.key === 'f') {
                e.preventDefault();
                openFabMenu();
            }
        });

        // Initialize tooltips
        document.addEventListener('DOMContentLoaded', function() {
            const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            tooltipTriggerList.map(function(tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl);
            });

            // Create water drops
            createWaterDrops();

            // Animate counters
            document.querySelectorAll('.stat-value[data-target]').forEach(animateCounter);

            // Initialize charts
            initializeOverviewCharts();

            // Tab change handlers
            const tabButtons = document.querySelectorAll('button[data-bs-toggle="pill"]');
            tabButtons.forEach(button => {
                button.addEventListener('shown.bs.tab', function(e) {
                    const targetId = e.target.getAttribute('data-bs-target').substring(1);
                    
                    if (targetId === 'quantitative' && !chartInstances.quantitativeInitialized) {
                        setTimeout(() => {
                            initializeQuantitativeCharts();
                            chartInstances.quantitativeInitialized = true;
                        }, 100);
                    } else if (targetId === 'qualitative' && !chartInstances.qualitativeInitialized) {
                        setTimeout(() => {
                            initializeQualitativeCharts();
                            chartInstances.qualitativeInitialized = true;
                        }, 100);
                    } else if (targetId === 'recommendations' && !chartInstances.recommendationsInitialized) {
                        setTimeout(() => {
                            initializeRecommendationsCharts();
                            chartInstances.recommendationsInitialized = true;
                        }, 100);
                    }
                });
            });

            // Button event listeners
            document.getElementById('printBtn').addEventListener('click', function() {
                window.print();
                showToast('Preparing print view...');
            });

            document.getElementById('downloadBtn').addEventListener('click', function() {
                downloadExcel();
                showToast('Downloading Excel file...');
            });

            // NEW: Dark mode toggle
            document.getElementById('darkModeToggle').addEventListener('click', toggleDarkMode);

            // NEW: FAB click handler
            document.getElementById('fab').addEventListener('click', openFabMenu);

            // NEW: Filter change handlers
            document.getElementById('areaFilter').addEventListener('change', updateCharts);
            document.getElementById('dateFilter').addEventListener('change', updateCharts);
            document.getElementById('dataTypeFilter').addEventListener('change', updateCharts);
        });

        // Update charts based on filters
        function updateCharts() {
            const areaFilter = document.getElementById('areaFilter').value;
            const dateFilter = document.getElementById('dateFilter').value;
            const dataTypeFilter = document.getElementById('dataTypeFilter').value;
            
            // In a real application, you would fetch new data based on filters
            // For this demo, we'll just show a toast
            showToast(`Filters applied: ${areaFilter}, ${dateFilter}, ${dataTypeFilter}`);
        }

        // Initialize Overview Charts
        function initializeOverviewCharts() {
            createTimelineChart('timelineChart');
            createDataCollectionChart('dataCollectionChart');
            createEngagementChart('engagementChart');
        }

        // Initialize Quantitative Charts
        function initializeQuantitativeCharts() {
            createHouseholdChart('householdChart', [33.5, 25, 25, 16.5]);
            createDwellingChart('dwellingChart', [64.3, 19, 4.8, 11.9]);
            createOwnershipChart('ownershipChart', [50, 35.7, 14.3]);
            createMeterChart('meterChart', [59.5, 26.2, 14.3]);
            createShortageChart('shortageChart', [66.7, 19, 2.4, 11.9]);
            createInfrastructureChart('infrastructureChart', [21.4, 9.5, 21.4, 21.4, 7.1, 19]);
            createDevicesChart('devicesChart', [57.1, 11.9, 9.5, 7.1, 2.4, 11.9]);
            createGardenChart('gardenChart', [38.1, 26.2, 9.5, 7.1, 7.1, 11.9]);
            createEducationChart('educationChart', [38.1, 45.2, 4.8, 11.9]);
            createWillingnessChart('willingnessChart', [73.8, 7.1, 19]);
        }

        // Initialize Qualitative Charts
        function initializeQualitativeCharts() {
            createCommunicationChart('communicationChart');
            createSummitChart('summitChart');
        }

        // Initialize Recommendations Charts
        function initializeRecommendationsCharts() {
            createImplementationChart('implementationChart');
            createImpactChart('impactChart');
        }

        // Chart creation functions
        function createTimelineChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Summit'],
                    datasets: [{
                        label: 'Surveys Completed',
                        data: [12, 30, 25, 150],
                        backgroundColor: colors.primary[0],
                        borderRadius: 10
                    }, {
                        label: 'Community Engagement',
                        data: [45, 75, 80, 200],
                        backgroundColor: colors.primary[2],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of Participants'
                            }
                        }
                    }
                }
            });
        }

        function createDataCollectionChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Household Surveys', 'Summit Feedback', 'Focus Groups', 'Observational Data'],
                    datasets: [{
                        data: [67, 150, 45, 30],
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createEngagementChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Workshop Interest', 'Water Concern', 'Community Role Belief', 'Willingness to Adopt'],
                    datasets: [{
                        data: [78, 80, 90, 75],
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createHouseholdChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['6 or more', '1 person', '4-5 people', '2-3 people'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createDwellingChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Brick house', 'Informal settlement', 'RDP house', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createOwnershipChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Own', 'Rent', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createMeterChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createShortageChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Occasionally', 'Frequently', 'Rarely', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createInfrastructureChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'polarArea',
                data: {
                    labels: ['Poor', 'Very poor', 'Fair', 'Good', 'Excellent', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary.map(c => c + 'CC')
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createDevicesChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Dual-flush toilet', 'Dual-flush + Low-flow', 'Low-flow showerhead', 'Dual-flush + Greywater', 'Greywater system', 'None/Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createGardenChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ["Don't water garden", 'Hosepipe', 'Not applicable', 'Bucket', 'Sprinkler', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: colors.primary,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createEducationChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Yes', 'No', 'Not sure', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[2], colors.primary[3]],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { callback: value => value + '%' }
                        }
                    },
                    plugins: {
                        legend: { display: false }
                    }
                }
            });
        }

        function createWillingnessChart(canvasId, data) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Yes', 'Maybe', 'Missing'],
                    datasets: [{
                        data: data,
                        backgroundColor: [colors.primary[0], colors.primary[1], colors.primary[3]],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '60%',
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createCommunicationChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Lack of outage info', 'Meter issues', 'Greywater reliance', 'Reporting knowledge gap', 'Prefer local offices'],
                    datasets: [{
                        label: 'Residents Reporting Issue',
                        data: [85, 70, 65, 60, 75],
                        backgroundColor: colors.primary[0],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    indexAxis: 'y',
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createSummitChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Water pollution', 'Lack of bins', 'Blockages', 'Technical capacity'],
                    datasets: [{
                        label: 'Problems Identified',
                        data: [80, 75, 70, 65],
                        backgroundColor: colors.primary[1],
                        borderRadius: 10
                    }, {
                        label: 'Solutions Proposed',
                        data: [85, 80, 75, 90],
                        backgroundColor: colors.primary[2],
                        borderRadius: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createImplementationChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Q1 2024', 'Q2 2024', 'Q3 2024', 'Q4 2024', 'Q1 2025'],
                    datasets: [{
                        label: 'Report Leaks App',
                        data: [10, 40, 70, 90, 100],
                        borderColor: colors.primary[0],
                        backgroundColor: colors.primary[0] + '20',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Community Plumbing Network',
                        data: [5, 25, 60, 85, 95],
                        borderColor: colors.primary[1],
                        backgroundColor: colors.primary[1] + '20',
                        tension: 0.3,
                        fill: true
                    }, {
                        label: 'Education Campaigns',
                        data: [15, 45, 75, 90, 100],
                        borderColor: colors.primary[2],
                        backgroundColor: colors.primary[2] + '20',
                        tension: 0.3,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        function createImpactChart(canvasId) {
            const ctx = document.getElementById(canvasId);
            if (!ctx) return;
            
            chartInstances[canvasId] = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Leak Reporting', 'Response Time', 'Water Conservation', 'Community Engagement', 'Infrastructure Rating'],
                    datasets: [{
                        label: 'Current',
                        data: [30, 40, 45, 65, 50],
                        backgroundColor: colors.primary[0],
                        borderRadius: 5
                    }, {
                        label: 'Target (12 months)',
                        data: [80, 75, 70, 85, 75],
                        backgroundColor: colors.primary[2],
                        borderRadius: 5
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                callback: value => value + '%'
                            }
                        }
                    }
                }
            });
        }

        // Download Excel functionality
        function downloadExcel() {
            const data = [
                ['Water Wise Soweto Outreach - Final Report Data', '', '', ''],
                ['', '', '', ''],
                ['Quantitative Analysis Summary', '', '', ''],
                ['Metric', 'Value', 'Insight', ''],
                ['Household Size (4-5 people)', '25%', 'Average household size', ''],
                ['Brick House Dwellings', '64.3%', 'Majority housing type', ''],
                ['Property Ownership', '50%', 'Half of residents own their property', ''],
                ['Water Meter Access', '59.5%', 'Significant portion lack functional meters', ''],
                ['Water Shortages (Occasionally)', '66.7%', 'Most experience regular shortages', ''],
                ['Infrastructure Rating (Fair)', '21.4%', 'Infrastructure generally rated as fair', ''],
                ['Water-Saving Devices', '15-20%', 'Low adoption of water-saving technology', ''],
                ['Water Conservation Education', '45%', 'Less than half received education', ''],
                ['Workshop Interest', '78%', 'Strong community interest in workshops', ''],
                ['Willingness to Adopt', '75%', 'High willingness to adopt water-saving practices', ''],
                ['', '', '', ''],
                ['Qualitative Insights Summary', '', '', ''],
                ['Challenge', 'Impact', 'Resident Quote', ''],
                ['Lack of Communication', 'High', '"We don\'t know when water will go. No one tells us."', ''],
                ['Non-functional Meters', 'Medium-High', '"Our meter doesn\'t work, and no one comes to fix it."', ''],
                ['Greywater Reliance', 'Medium', '"We wash food with grey water when there\'s no water."', ''],
                ['Reporting Knowledge Gap', 'High', 'Over 60% didn\'t know how to report leaks', ''],
                ['Preference for Local Support', 'Medium', 'Residents prefer local offices over phone support', ''],
                ['', '', '', ''],
                ['Key Recommendations', '', '', ''],
                ['Recommendation', 'Priority', 'Expected Impact', ''],
                ['Launch "Report Leaks App"', 'High', 'Faster response to water issues', ''],
                ['Build Community Plumbing Network', 'High', 'Local jobs + faster repairs', ''],
                ['Design Educational Campaigns', 'Medium', 'Increased water conservation awareness', ''],
                ['Install community noticeboards/SMS alerts', 'High', 'Better communication on outages', ''],
                ['Expand Soweto model to other areas', 'Medium', 'Broader community impact', ''],
                ['Visualize insights in Power BI/Tableau', 'Low', 'Dynamic tracking and reporting', '']
            ];

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Soweto Final Report");
            XLSX.writeFile(wb, "Water_Wise_Soweto_Final_Report.xlsx");
        }
    </script>
</body>
</html>